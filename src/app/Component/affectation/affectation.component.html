<div class="affectation-container">
  <h2>üß© Affecter Module √† des Classes</h2>

  <form (ngSubmit)="affecter()" class="form-section" novalidate>
    <!-- Module -->
    <div>
      <label for="moduleSelect">Module</label>
      <select id="moduleSelect" [(ngModel)]="selectedModuleId" name="module" required>
              <option value="" disabled selected>-- Choisir un module --</option>
        <option *ngFor="let module of modules" [value]="module.id">
          {{ module.libelleModule }}
        </option>
      </select>
    </div>

    <!-- Option Classe -->
    <div>
      <label for="optionSelect">Option</label>
     <select
  [(ngModel)]="selectedOptionGroupe"
  (change)="onOptionGroupeChange($event)"
  name="optionGroupe"
  required
>
  <option *ngFor="let option of optionsGroupe" [value]="option">{{ option }}</option>
</select>

    </div>

    <!-- Classes filtr√©es par option -->
    <div class="full-width">
     <label for="groupesSelect">Classes (s√©lection multiple possible)</label>
<select
  id="groupesSelect"
  multiple
  [(ngModel)]="selectedGroupeIds"
  name="groupes"
  required
  size="6"
>
  <option *ngFor="let g of filteredGroupes" [value]="g.id">
    {{ getDisplayClassName(g) }} ‚Äî Niveau: {{ g.niveau }} ‚Äî Effectif: {{ g.effectif }} ‚Äî D√©partement: {{ g.departement }}
  </option>
</select>

    </div>

    <!-- P√©riode -->
    <div>
      <label for="periodeSelect">P√©riode</label>
      <select id="periodeSelect" [(ngModel)]="selectedPeriode" name="periode" required>
        <option *ngFor="let p of periodes" [value]="p">{{ p }}</option>
      </select>
    </div>

    <div></div> <!-- vide pour garder grille align√©e -->

    <button type="submit" class="btn-affecter" aria-label="Affecter le module aux classes">
      ‚úÖ Affecter
    </button>
  </form>

  <hr />

  <h3>üìã Liste des Affectations</h3>
  <table class="table" aria-label="Liste des affectations">
    <thead>
      <tr>
        <th>Module</th>
        <th>Classe</th>
        <th>P√©riode</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let aff of affectations">
        <td>{{ aff.module.libelleModule }}</td>
        <td>
  {{ getDisplayClassName(aff.groupe) }}
  <br />
  <small *ngIf="aff.groupe.niveau">
    Niveau: {{ aff.groupe.niveau }} |
    Option: {{ aff.groupe.optionGroupe }} |
    Effectif: {{ aff.groupe.effectif }} |
    D√©partement: {{ aff.groupe.departement }}
  </small>
</td>

        <td>{{ aff.periode }}</td>
        <td>
          <button (click)="deleteAffectation(aff.id)" aria-label="Supprimer l'affectation">
            ‚ùå Supprimer
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

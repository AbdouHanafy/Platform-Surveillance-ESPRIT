<div class="affectation-container">
  <h2>üè¢ Affectation Automatique des Salles</h2>

  <!-- Simple One-Click Assignment Section -->
  <div class="auto-assignment-section">
    <button 
      type="button" 
      class="btn-auto-assign" 
      (click)="assignAllSallesRandomly()"
      [disabled]="isAssigning">
      <i class="pi pi-home"></i>
      {{ isAssigning ? 'Affectation en cours...' : 'Affecter TOUTES les Salles Automatiquement' }}
    </button>
  </div>

  <hr />

  <h3>üìã Liste des Modules avec Affectation de Salles</h3>
  <table class="table" aria-label="Liste des affectations de salles">
    <thead>
      <tr>
        <th>Module</th>
        <th>Groupe</th>
        <th>P√©riode</th>
        <th>Date/Horaire</th>
        <th>Salle Affect√©e</th>
        <th>Enseignant</th>
        <th>Statut</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let affectation of affectations">
        <td>{{ affectation.module.libelleModule }}</td>
        <td>
          {{ getDisplayClassName(affectation.groupe) }}
          <br />
          <small>
            Effectif: {{ affectation.groupe.effectif }} |
            D√©partement: {{ affectation.groupe.departement }}
          </small>
        </td>
        <td>{{ affectation.periode }}</td>
        <td>
          {{ affectation.date | date: 'dd/MM/yyyy' }}
          <br />
          <small>{{ affectation.heureDebut }} - {{ affectation.heureFin }}</small>
        </td>
        <td>
          <div *ngIf="affectation.salleAffectee" class="assigned-info">
            <i class="pi pi-check-circle text-success"></i>
            {{ affectation.salleNom }}
            <small>({{ affectation.salleCapacite }} places)</small>
          </div>
          <div *ngIf="!affectation.salleAffectee" class="unassigned-info">
            <i class="pi pi-times-circle text-warning"></i>
            Non affect√©e
          </div>
        </td>
        <td>
          <div *ngIf="affectation.enseignantAffecte" class="assigned-info">
            <i class="pi pi-user text-info"></i>
            {{ affectation.enseignantNom }}
          </div>
          <div *ngIf="!affectation.enseignantAffecte" class="unassigned-info">
            <i class="pi pi-user-minus text-muted"></i>
            Non affect√©
          </div>
        </td>
        <td>
          <span class="status-badge" [ngClass]="getStatusClass(affectation.statut)">
            {{ getStatusLabel(affectation.statut) }}
          </span>
        </td>
        <td>
          <button 
            *ngIf="!affectation.salleAffectee"
            (click)="assignSalleToModule(affectation)" 
            class="btn-assign-individual"
            [disabled]="isAssigning"
            aria-label="Affecter une salle √† ce module">
            üè¢ Affecter Salle
          </button>
          <button 
            *ngIf="affectation.salleAffectee"
            (click)="removeSalleFromModule(affectation.id)" 
            class="btn-remove"
            aria-label="Retirer la salle">
            ‚ùå Retirer
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Statistics Section -->
  <div class="stats-section">
    <div class="stat-card">
      <h4>üìä Statistiques</h4>
      <p><strong>Total modules:</strong> {{ affectations.length }}</p>
      <p><strong>Salles affect√©es:</strong> {{ getSallesAssignedCount() }}</p>
      <p><strong>En attente:</strong> {{ getUnassignedSallesCount() }}</p>
      <p><strong>Taux d'affectation:</strong> {{ getSalleAssignmentRate() }}%</p>
    </div>
  </div>
</div>